<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ›¡ï¸ CybersÃ©curitÃ© â€” Challenge Terminal</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone@7.24.0/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body, #root { height: 100%; width: 100%; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel" data-presets="react">

const { useState, useEffect, useRef, useCallback } = React;

const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];
const shuffle = (arr) => [...arr].sort(() => Math.random() - 0.5);
const randInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

const caesarShift = (text, shift) => {
  let result = "";
  for (let c of text.toUpperCase()) {
    if (c >= "A" && c <= "Z") {
      result += String.fromCharCode(((c.charCodeAt(0) - 65 + shift + 26) % 26) + 65);
    } else {
      result += c;
    }
  }
  return result;
};

const generateScanLevel = () => {
  const targets = [
    { ip: "192.168.1.42", ports: "22,8080", type: "SERVER" },
    { ip: "10.0.0.17", ports: "22,443,3306", type: "DATABASE" },
    { ip: "172.16.0.99", ports: "21,22,80", type: "WEB SERVER" },
  ];
  const target = pick(targets);
  const decoys = shuffle([
    { ip: "192.168.1.1", ports: "80,443", type: "ROUTER" },
    { ip: "192.168.1.10", ports: "22,80", type: "PRINTER" },
    { ip: "10.0.0.1", ports: "53,80", type: "DNS" },
    { ip: "172.16.0.1", ports: "80,443", type: "GATEWAY" },
    { ip: "192.168.1.25", ports: "554", type: "CAMERA" },
    { ip: "10.0.0.50", ports: "25,587", type: "MAIL" },
  ]).slice(0, 3);
  return {
    id: "scan", title: "RECONNAISSANCE",
    mission: "Scannez le rÃ©seau pour identifier la cible vulnÃ©rable. Tapez 'help' pour les commandes.",
    hint: "Tapez 'scan' puis connectez-vous Ã  la cible marquÃ©e VULNÃ‰RABLE.",
    topic: "Scan rÃ©seau & Reconnaissance",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘           COMMANDES DISPONIBLES              â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£","â•‘  scan            - Scanner le rÃ©seau         â•‘","â•‘  connect <ip>    - Se connecter Ã  une cible  â•‘","â•‘  nmap <ip>       - DÃ©tail des ports          â•‘","â•‘  mission / hint / score                      â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      scan: { response: ["âŸ³ Scanning rÃ©seau...",...decoys.map((d) => "  â”œâ”€ " + d.ip.padEnd(16) + " [" + d.type + "]" + "".padEnd(10 - d.type.length) + "Port " + d.ports),"  â””â”€ " + target.ip.padEnd(16) + " [" + target.type + "]" + "".padEnd(10 - target.type.length) + "Port " + target.ports + " âš  VULNÃ‰RABLE","","â†’ Cible dÃ©tectÃ©e ! Tapez 'connect " + target.ip + "'"] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("connect ")) { const ip = input.slice(8).trim(); if (ip === target.ip) return null; return ["âœ— Connexion refusÃ©e Ã  " + ip]; }
      if (input.startsWith("nmap ")) { const ip = input.slice(5).trim(); const found = [...decoys, target].find((d) => d.ip === ip); if (found) { return ["NMAP " + ip + ":", "  Type: " + found.type, "  Ports: " + found.ports + (found === target ? " âš  VULNÃ‰RABLE" : "")]; } return ["âœ— HÃ´te non trouvÃ©."]; }
      return null;
    },
    checkWin: (input) => input === "connect " + target.ip,
    winResponse: ["âœ“ Connexion Ã©tablie avec " + target.ip, "", "âš  LEÃ‡ON : La reconnaissance est la 1Ã¨re Ã©tape d'un pentest.", "â†’ Outils rÃ©els : Nmap, Masscan, Shodan.", "â†’ DÃ©fense : fermer les ports inutiles, IDS/IPS."],
  };
};

const generateBruteForceLevel = (difficulty) => {
  const passwords = { "dÃ©butant": [{ pass: "admin", hint: "Login par dÃ©faut le plus courant." },{ pass: "password", hint: "Le mot de passe le plus utilisÃ© au monde." },{ pass: "123456", hint: "La suite de chiffres la plus Ã©vidente." }], "intermÃ©diaire": [{ pass: "root", hint: "Compte superutilisateur Linux." },{ pass: "toor", hint: "Root Ã  l'envers." },{ pass: "changeme", hint: "Password par dÃ©faut classique." }], "expert": [{ pass: "P@ssw0rd", hint: "Leet speak basique." },{ pass: "Welcome1", hint: "Password initial en entreprise." },{ pass: "Summer2024", hint: "Pattern saisonnier+annÃ©e." }] };
  const chosen = pick(passwords[difficulty]);
  const maxAttempts = difficulty === "dÃ©butant" ? 10 : difficulty === "intermÃ©diaire" ? 7 : 5;
  let attempts = 0;
  const commonPasswords = shuffle(["123456","password","admin","root","qwerty","letmein","welcome","monkey","dragon","master","abc123","111111","toor","changeme","P@ssw0rd","Welcome1","Summer2024","Winter2023","Company1","Azerty1"]);
  return {
    id: "bruteforce", title: "BRUTE FORCE",
    mission: "Le serveur demande un mot de passe. Vous avez " + maxAttempts + " tentatives. Testez avec 'try <password>'.",
    hint: chosen.hint, topic: "Mots de passe faibles & Brute force",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  try <mdp>     - Tester un mot de passe      â•‘","â•‘  wordlist      - Passwords courants           â•‘","â•‘  attempts      - Tentatives restantes         â•‘","â•‘  explain       - En savoir plus               â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      wordlist: { response: ["ğŸ“‹ Passwords frÃ©quents :", ...commonPasswords.slice(0, 12).map((p, i) => "  " + (i + 1).toString().padStart(2) + ". " + p), "", "âš  80% des breaches impliquent des mots de passe faibles."] },
      explain: { response: ["ğŸ“– BRUTE FORCE","â”â”â”â”â”â”â”â”â”â”â”â”â”â”","Tester systÃ©matiquement tous les mots de passe possibles.","","Variantes :","  â€¢ Dictionnaire","  â€¢ Hybride (mots + variations)","  â€¢ Pur (toutes combinaisons)","","Outils : Hydra, John the Ripper, Hashcat.","DÃ©fense : rate limiting, 2FA, 12+ caractÃ¨res."] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("try ")) { const guess = input.slice(4).trim(); attempts++; if (guess === chosen.pass) return null; const remaining = maxAttempts - attempts; if (remaining <= 0) { attempts = 0; return ["âœ— Plus de tentatives ! Password: " + chosen.pass, "â†’ Compteur rÃ©initialisÃ©."]; } return ["âœ— AccÃ¨s refusÃ©. (" + remaining + " restantes)"]; }
      if (input === "attempts") return ["Tentatives: " + (maxAttempts - attempts) + "/" + maxAttempts];
      if (input === "retry") { attempts = 0; return ["âŸ³ RÃ©initialisÃ©. " + maxAttempts + " tentatives."]; }
      return null;
    },
    checkWin: (input) => input.startsWith("try ") && input.slice(4).trim() === chosen.pass,
    winResponse: ["âœ“ ACCÃˆS ! Password crackÃ© : \"" + chosen.pass + "\"", "  TrouvÃ© en " + (attempts + 1) + " tentative(s).", "", "âš  LEÃ‡ON :", "â†’ Ne jamais utiliser de passwords par dÃ©faut.", "â†’ Minimum 12 caractÃ¨res variÃ©s.", "â†’ Gestionnaire de mots de passe (Bitwarden, KeePass).", "â†’ Activer le 2FA."],
  };
};

const generateCaesarLevel = (difficulty) => {
  const messages = { "dÃ©butant": ["ATTAQUE A MIDI","MOT DE PASSE FRAGILE","ALERTE SECURITE"], "intermÃ©diaire": ["RENDEZ VOUS AU SERVEUR NORD","TRANSFERT DE DONNEES EN COURS","CLEF COMPROMISE CHANGER URGENT"], "expert": ["EXTRACTION FICHIER CONFIDENTIEL CONFIRME","PROTOCOLE EVACUATION ACTIVE CODE ROUGE","AGENT DOUBLE IDENTIFIE SECTEUR SEPT"] };
  const shifts = { "dÃ©butant": [3, 5], "intermÃ©diaire": [7, 11, 13], "expert": [17, 19, 23] };
  const plaintext = pick(messages[difficulty]);
  const shift = pick(shifts[difficulty]);
  const ciphertext = caesarShift(plaintext, shift);
  return {
    id: "caesar", title: "CHIFFREMENT CÃ‰SAR",
    mission: "Message interceptÃ© : '" + ciphertext + "'. Utilisez 'caesar <texte> <dÃ©calage>' pour tester.",
    hint: difficulty === "dÃ©butant" ? "Testez: caesar " + ciphertext + " -" + shift : "Utilisez 'bruteforce caesar' pour tester les 25 shifts.",
    topic: "Cryptographie â€” Chiffrement de CÃ©sar",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  caesar <texte> <n>   - Appliquer dÃ©calage   â•‘","â•‘  bruteforce caesar    - Tester les 25 shifts  â•‘","â•‘  explain              - Comprendre CÃ©sar      â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      "bruteforce caesar": { response: ["âŸ³ Test des 25 dÃ©calages :", "", ...Array.from({ length: 25 }, (_, i) => { const s = -(i + 1); const r = caesarShift(ciphertext, s); return "  ROT " + String(s).padStart(3) + " â†’ " + r.slice(0, 40) + (r === plaintext ? " â—„â—„â—„ LISIBLE !" : ""); }), "", "â†’ RepÃ©rez le texte lisible !"] },
      explain: { response: ["ğŸ“– CHIFFREMENT DE CÃ‰SAR","â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”","Chaque lettre dÃ©calÃ©e de N positions.","Faiblesse : 25 clÃ©s possibles.","Moderne : AES-256 (2Â²âµâ¶ clÃ©s)."] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("caesar ")) { const parts = input.split(" "); const sh = parseInt(parts[parts.length - 1]); if (isNaN(sh)) return ["âœ— Format: caesar <texte> <dÃ©calage>"]; const text = parts.slice(1, -1).join(" ").toUpperCase(); const result = caesarShift(text, sh); if (result === plaintext) return null; return ["â†’ " + result, "", "Pas le bon dÃ©calage..."]; }
      return null;
    },
    checkWin: (input) => { if (!input.startsWith("caesar ")) return false; const parts = input.split(" "); const sh = parseInt(parts[parts.length - 1]); if (isNaN(sh)) return false; return caesarShift(parts.slice(1, -1).join(" ").toUpperCase(), sh) === plaintext; },
    winResponse: ["âœ“ MESSAGE DÃ‰CHIFFRÃ‰ : " + plaintext, "  DÃ©calage : " + shift, "", "âš  LEÃ‡ON :", "â†’ CÃ©sar = cassable en secondes.", "â†’ Chiffrement moderne : clÃ©s 128-256 bits."],
  };
};

const generateBase64Level = (difficulty) => {
  const secrets = { "dÃ©butant": ["Serveur Secret","Admin Panel","Root Access"], "intermÃ©diaire": ["mysql://admin:tiger@db.internal:3306","api_key=sk-9f8e7d6c5b4a3210"], "expert": ['{"user":"admin","role":"superadmin","token":"x7k9m2"}',"password_hash=5f4dcc3b5aa765d61d8327deb882cf99"] };
  const secret = pick(secrets[difficulty]);
  const encoded = btoa(secret);
  return {
    id: "base64", title: "ENCODAGE BASE64",
    mission: "DonnÃ©es interceptÃ©es : '" + encoded + "'. DÃ©codez avec 'decode <texte>'.",
    hint: "Tapez: decode " + encoded, topic: "Encodage vs Chiffrement",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  decode <texte>    - DÃ©coder du Base64        â•‘","â•‘  encode <texte>    - Encoder en Base64        â•‘","â•‘  explain           - Comprendre Base64        â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      explain: { response: ["ğŸ“– BASE64","â”â”â”â”â”â”â”â”â”","Convertit binaire â†’ texte ASCII.","","âš  CE N'EST PAS DU CHIFFREMENT !","â†’ Pas de clÃ©. Tout le monde peut dÃ©coder.","â†’ Utiliser bcrypt/Argon2 pour le hachage."] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("decode ")) { try { const decoded = atob(input.slice(7).trim()); if (decoded === secret) return null; return ["â†’ DÃ©codÃ© : " + decoded]; } catch(e) { return ["âœ— Base64 invalide."]; } }
      if (input.startsWith("encode ")) return ["â†’ EncodÃ© : " + btoa(input.slice(7).trim())];
      return null;
    },
    checkWin: (input) => { if (!input.startsWith("decode ")) return false; try { return atob(input.slice(7).trim()) === secret; } catch(e) { return false; } },
    winResponse: ["âœ“ DÃ‰CODÃ‰ : " + secret, "", "âš  LEÃ‡ON :", "â†’ Base64 = rÃ©versible sans clÃ©.", "â†’ Ne JAMAIS l'utiliser pour protÃ©ger des donnÃ©es."],
  };
};

const generateSQLiLevel = (difficulty) => {
  const scenarios = { "intermÃ©diaire": { table: "users", query: "SELECT * FROM users WHERE username='{INPUT}' AND password='{PASS}'", hint: "admin' --" }, "expert": { table: "accounts", query: "SELECT * FROM accounts WHERE login='{INPUT}' AND token=SHA256('{PASS}')", hint: "admin' UNION SELECT * FROM accounts --" } };
  const sc = scenarios[difficulty] || scenarios["intermÃ©diaire"];
  return {
    id: "sqli", title: "INJECTION SQL",
    mission: "Formulaire de login (table: " + sc.table + "). Exploitez avec 'login <user> <pass>'.",
    hint: sc.hint, topic: "Injection SQL (OWASP #1)",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  login <user> <pass> - Tenter une connexion   â•‘","â•‘  view query          - Voir la requÃªte SQL    â•‘","â•‘  explain             - Comprendre SQLi        â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      "view query": { response: ["ğŸ“‹ RequÃªte :", "", "  " + sc.query, "", "â†’ Que se passe-t-il si vous injectez une quote ?"] },
      explain: { response: ["ğŸ“– INJECTION SQL","â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”","Techniques :","  â€¢ admin' -- (commentaire)","  â€¢ ' OR '1'='1 (toujours vrai)","  â€¢ UNION SELECT","","DÃ©fense : prepared statements, ORM, WAF."] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("login ")) { const p = input.slice(6); if (p.includes("' --") || p.includes("'--") || p.toLowerCase().includes("' or '1'='1") || p.toLowerCase().includes("' or 1=1") || p.toLowerCase().includes("union select")) return null; return ["âœ— Identifiants incorrects."]; }
      return null;
    },
    checkWin: (input) => { if (!input.startsWith("login ")) return false; const p = input.slice(6).toLowerCase(); return p.includes("' --") || p.includes("'--") || p.includes("' or '1'='1") || p.includes("' or 1=1") || p.includes("union select"); },
    winResponse: ["âœ“ INJECTION RÃ‰USSIE ! ConnectÃ© admin.", "", "âš  LEÃ‡ON :", "â†’ TOUJOURS utiliser des prepared statements.", "â†’ Ne jamais concatÃ©ner des entrÃ©es dans du SQL."],
  };
};

const generatePhishingLevel = (difficulty) => {
  const emailSets = {
    "dÃ©butant": [
      { from: "[email protected]", subject: "RÃ©union vendredi", body: "Bonjour,\nRÃ©union Ã  vendredi 14h, salle B204.\nCordialement, Marie", legit: true },
      { from: "[email protected]", subject: "âš  URGENT : Compte suspendu !", body: "Cher client,\nActivitÃ© suspecte.\nâ†’ http://banque-france.security-check.xyz/login\n\nCompte BLOQUÃ‰ dans 24h.", legit: false, indices: ["securite-banque.com â‰  site officiel","URL: security-check.xyz â†’ frauduleux","Urgence artificielle"] },
      { from: "[email protected]", subject: "Mise Ã  jour sÃ©curitÃ©", body: "Mise Ã  jour sur https://support.microsoft.com\nPatch KB5034441.", legit: true },
    ],
    "intermÃ©diaire": [
      { from: "[email protected]", subject: "VÃ©rification sÃ©curitÃ©", body: "Suite Ã  notre audit :\nâ†’ https://microsoft-365-security.com/verify", legit: false, indices: ["microsoft-365-security.com â‰  microsoft.com","Le 'o' est un zÃ©ro","Microsoft ne demande jamais Ã§a par email"] },
      { from: "[email protected]", subject: "Formation CybersÃ©curitÃ©", body: "Inscription confirmÃ©e pour le 15 mars.\nLien Teams : https://teams.microsoft.com/meet/abc123", legit: true },
      { from: "[email protected]", subject: "Document partagÃ©", body: "Jean-Marc a partagÃ© 'Budget_Q4.xlsx'.\nâ†’ https://docs.google.com/spreadsheets/d/1a2b3c", legit: true },
    ],
    "expert": [
      { from: "[email protected]", subject: "Re: AccÃ¨s VPN - Ticket #4892", body: "Nouveau client VPN :\nâ†’ https://vpn-corporate.entreprise-solutions.net/download\n\nInstaller avant vendredi.", legit: false, indices: ["entreprise-solutions.net â‰  domaine interne","TÃ©lÃ©chargement via email = suspect","'Re:' sans conversation = social engineering"] },
      { from: "[email protected]", subject: "Certificat SSL expire", body: "Certificat expire dans 7 jours.\nhttps://portal.azure.com/certificates", legit: true },
      { from: "[email protected]", subject: "Facture #INV-2024-0892", body: "Facture janvier : 4 250 â‚¬\nhttps://facturation.ovhcloud.com/invoices/892", legit: true },
    ],
  };
  const emails = emailSets[difficulty];
  const phishIndex = emails.findIndex((e) => !e.legit);
  return {
    id: "phishing", title: "DÃ‰TECTION PHISHING",
    mission: emails.length + " emails interceptÃ©s. Tapez 'read <n>' puis 'report <n>'.",
    hint: "Le phishing est l'email #" + (phishIndex + 1), topic: "Phishing & IngÃ©nierie sociale",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  read <1-3>      - Lire un email             â•‘","â•‘  report <1-3>    - Signaler comme phishing   â•‘","â•‘  analyze <1-3>   - Analyser les headers      â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      explain: { response: ["ğŸ“– PHISHING","â”â”â”â”â”â”â”â”â”â”â”","ğŸ”´ Signaux : domaine suspect, URL louche, urgence","ğŸŸ¢ VÃ©rifier : survoler liens, checker domaine"] },
    },
    defaultResponse: (input) => {
      const match = input.match(/^(read|report|analyze) (\d)$/);
      if (!match) return null;
      const action = match[1]; const idx = parseInt(match[2]) - 1;
      if (idx < 0 || idx >= emails.length) return ["âœ— Email inexistant."];
      const email = emails[idx];
      if (action === "read") return ["â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•","ğŸ“§ EMAIL #" + (idx+1),"De: " + email.from,"Objet: " + email.subject,"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",...email.body.split("\n"),"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"];
      if (action === "analyze") { const domain = email.from.split("@")[1]; return ["ğŸ” Headers #" + (idx+1) + " :","  From: " + email.from,"  SPF: " + (email.legit ? "PASS" : "SOFTFAIL"),"  DKIM: " + (email.legit ? "PASS" : "NONE"), !email.legit ? "  âš  Authentification Ã©chouÃ©e !" : ""]; }
      if (action === "report") { if (!email.legit) return null; return ["âœ— Email lÃ©gitime. Cherchez mieux !"]; }
      return null;
    },
    checkWin: (input) => { const match = input.match(/^report (\d)$/); if (!match) return false; return parseInt(match[1]) - 1 === phishIndex; },
    winResponse: ["âœ“ CORRECT ! Phishing identifiÃ© !", "", "ğŸ” Indices :", ...emails[phishIndex].indices.map((i) => "  â€¢ " + i), "", "âš  91% des cyberattaques commencent par du phishing."],
  };
};

const generateHashLevel = () => {
  const hashes = [{ plain: "password", md5: "5f4dcc3b5aa765d61d8327deb882cf99" },{ plain: "admin", md5: "21232f297a57a5a743894a0e4a801fc3" },{ plain: "letmein", md5: "0d107d09f5bbe40cade3de5c71e9e9b7" }];
  const chosen = pick(hashes);
  return {
    id: "hash", title: "RAINBOW TABLES",
    mission: "Hash MD5 : '" + chosen.md5 + "'. Tapez 'rainbow <hash>' ou 'crack <hash>'.",
    hint: "Tapez: rainbow " + chosen.md5, topic: "Hachage & Rainbow Tables",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  rainbow <hash>  - Rainbow table              â•‘","â•‘  crack <hash>    - Dictionnaire               â•‘","â•‘  hash <texte>    - Calculer le hash           â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      explain: { response: ["ğŸ“– HACHAGE","â”â”â”â”â”â”â”â”â”â”","MD5: 128 bits (CASSÃ‰)","SHA-256: 256 bits (sÃ»r)","bcrypt: RECOMMANDÃ‰","","Rainbow table = hash prÃ©-calculÃ©s.","DÃ©fense : sel (salt) unique."] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("rainbow ") || input.startsWith("crack ")) { const h = input.split(" ").slice(1).join(" ").trim(); if (h === chosen.md5) return null; return ["âœ— Hash non trouvÃ©."]; }
      if (input.startsWith("hash ")) { const text = input.slice(5).trim(); if (text === chosen.plain) return ["â†’ MD5(" + text + ") = " + chosen.md5, "C'est le mÃªme hash !"]; return ["â†’ MD5(" + text + ") = " + Array.from({length:32},()=>"0123456789abcdef"[randInt(0,15)]).join("")]; }
      return null;
    },
    checkWin: (input) => { if (!input.startsWith("rainbow ") && !input.startsWith("crack ")) return false; return input.split(" ").slice(1).join(" ").trim() === chosen.md5; },
    winResponse: ["âŸ³ Rainbow table...","  " + chosen.md5 + " â†’ \"" + chosen.plain + "\"","","âœ“ PASSWORD : " + chosen.plain,"","âš  MD5/SHA-1 CASSÃ‰S. Utiliser bcrypt/Argon2."],
  };
};

const generateOSINTLevel = () => {
  const targets = [
    { name: "Alex Morin", username: "alexm_dev", bio: "Full-stack dev | Paris | Cat lover | Born 15/03/1995", posts: ["Deployed on AWS us-east-1 !","Birthday dinner ğŸ‚","My cat Pixel turned 3 !","Working from CafÃ© de Flore"], password: "Pixel1503", hint: "Chat + date naissance JJMM." },
    { name: "Sarah Benali", username: "sarah.benali", bio: "Marketing @TechCorp | Lyon | Dog mom to Oscar", posts: ["Oscar fÃªte ses 5 ans !","Paris Marathon 4h12 !","Throwback wedding 07/07/2019","Working late..."], password: "Oscar0707", hint: "Chien + date importante JJMM." },
  ];
  const target = pick(targets);
  return {
    id: "osint", title: "OSINT - RENSEIGNEMENT",
    mission: "Cible : " + target.name + " (@" + target.username + "). Tapez 'try <password>'.",
    hint: target.hint, topic: "OSINT & IngÃ©nierie Sociale",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  profile / posts / try <password> / explain  â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      profile: { response: ["ğŸ‘¤ @" + target.username,"   " + target.name,"   Bio: " + target.bio,"   Followers: " + randInt(200,2000)] },
      posts: { response: ["ğŸ“± @" + target.username + " :", ...target.posts.map((p,i) => "  " + ["ğŸ• 2h","ğŸ•‘ 1j","ğŸ•’ 3j","ğŸ•“ 1sem"][i] + " â”‚ " + p)] },
      explain: { response: ["ğŸ“– OSINT","â”â”â”â”â”â”â”â”","Noms d'animaux â†’ passwords","Dates perso â†’ codes PIN","Outils : Maltego, Sherlock, Google Dorks"] },
    },
    defaultResponse: (input) => { if (input.startsWith("try ")) { if (input.slice(4).trim() === target.password) return null; return ["âœ— Incorrect. Analysez le profil."]; } return null; },
    checkWin: (input) => input.startsWith("try ") && input.slice(4).trim() === target.password,
    winResponse: ["âœ“ ACCÃˆS ! Password : \"" + target.password + "\"","","â†’ Ne JAMAIS utiliser d'infos personnelles.","â†’ Utiliser un gÃ©nÃ©rateur alÃ©atoire."],
  };
};

const generateNetworkLevel = () => {
  const suspicious = "192.168.1.105"; const malicious = "185.143.223.1";
  const logs = ["10:01:03 | 192.168.1.100 â†’ 192.168.1.1   | TCP | Port 80   | HTTP","10:01:05 | 192.168.1.100 â†’ 8.8.8.8        | UDP | Port 53   | DNS","10:01:07 | 192.168.1.105 â†’ 45.33.32.156   | TCP | Port 443  | TLS","10:01:09 | " + suspicious + " â†’ " + malicious + "  | TCP | Port 4444 | DATA â–ˆâ–ˆâ–ˆâ–ˆ","10:01:11 | 192.168.1.100 â†’ 192.168.1.1    | TCP | Port 443  | HTTPS","10:01:13 | " + malicious + " â†’ " + suspicious + "  | TCP | Port 4444 | DATA â–ˆâ–ˆâ–ˆâ–ˆ","10:01:15 | 192.168.1.100 â†’ 192.168.1.50   | TCP | Port 22   | SSH"];
  return {
    id: "network", title: "ANALYSE RÃ‰SEAU",
    mission: "Identifiez la machine compromise. Tapez 'logs' puis 'flag <ip>'.",
    hint: "Port 4444 = Metasploit. flag " + suspicious, topic: "Analyse de trafic rÃ©seau",
    commands: {
      help: { response: ["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘  logs / whois <ip> / flag <ip> / explain     â•‘","â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"] },
      logs: { response: ["ğŸ“‹ CAPTURE :", "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”", ...logs, "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"] },
      explain: { response: ["ğŸ“– ANALYSE RÃ‰SEAU","â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”","Ports suspects : 4444=Metasploit, 5555=ADB","Outils : Wireshark, tcpdump, Suricata"] },
    },
    defaultResponse: (input) => {
      if (input.startsWith("whois ")) { const ip = input.slice(6).trim(); if (ip === malicious) return ["ğŸ” " + ip + " : Russie, Bulletproof Hosting âš "]; if (ip === suspicious) return ["ğŸ” " + ip + " : DESKTOP-PC105, j.martin"]; return ["ğŸ” " + ip + " : rÃ©seau local"]; }
      if (input.startsWith("flag ")) { if (input.slice(5).trim() === suspicious) return null; return ["âœ— Mauvaise IP."]; }
      return null;
    },
    checkWin: (input) => input.startsWith("flag ") && input.slice(5).trim() === suspicious,
    winResponse: ["âœ“ MACHINE COMPROMISE : " + suspicious,"  Reverse shell port 4444 vers " + malicious,"","â†’ Surveiller les ports non-standard.","â†’ Outils : Wireshark, Suricata, Splunk."],
  };
};

const PROFILES = {
  "dÃ©butant": { label: "ğŸŸ¢ DÃ‰BUTANT", desc: "LycÃ©en / Curieux", color: "#0f0", levels: () => [generateScanLevel(), generateBruteForceLevel("dÃ©butant"), generateCaesarLevel("dÃ©butant"), generateBase64Level("dÃ©butant"), generatePhishingLevel("dÃ©butant")] },
  "intermÃ©diaire": { label: "ğŸŸ¡ INTERMÃ‰DIAIRE", desc: "Ã‰tudiant IT / Bac+2", color: "#ff0", levels: () => [generateScanLevel(), generateBruteForceLevel("intermÃ©diaire"), generateCaesarLevel("intermÃ©diaire"), generateBase64Level("intermÃ©diaire"), generateSQLiLevel("intermÃ©diaire"), generateOSINTLevel(), generatePhishingLevel("intermÃ©diaire")] },
  "expert": { label: "ğŸ”´ EXPERT", desc: "M1/M2 Cyber", color: "#f44", levels: () => [generateScanLevel(), generateBruteForceLevel("expert"), generateCaesarLevel("expert"), generateBase64Level("expert"), generateHashLevel(), generateSQLiLevel("expert"), generateOSINTLevel(), generateNetworkLevel(), generatePhishingLevel("expert")] },
};

const MatrixRain = () => {
  const canvasRef = useRef(null);
  useEffect(() => {
    const canvas = canvasRef.current; if (!canvas) return;
    const ctx = canvas.getContext("2d");
    const resize = () => { canvas.width = canvas.parentElement.offsetWidth; canvas.height = canvas.parentElement.offsetHeight; };
    resize();
    const chars = "01ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½"; const fontSize = 14;
    const columns = Math.floor(canvas.width / fontSize); const drops = Array(columns).fill(1);
    const draw = () => { ctx.fillStyle = "rgba(0,0,0,0.05)"; ctx.fillRect(0,0,canvas.width,canvas.height); ctx.fillStyle = "#0f0"; ctx.font = fontSize + "px monospace"; for (let i = 0; i < drops.length; i++) { ctx.globalAlpha = Math.random()*0.3+0.1; ctx.fillText(chars[Math.floor(Math.random()*chars.length)], i*fontSize, drops[i]*fontSize); if (drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0; drops[i]++; } ctx.globalAlpha = 1; };
    const interval = setInterval(draw, 50);
    window.addEventListener("resize", resize);
    return () => { clearInterval(interval); window.removeEventListener("resize", resize); };
  }, []);
  return <canvas ref={canvasRef} style={{ position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0.12,pointerEvents:"none" }} />;
};

function HackerGame() {
  const [screen, setScreen] = useState("menu");
  const [profile, setProfile] = useState(null);
  const [levels, setLevels] = useState([]);
  const [levelIdx, setLevelIdx] = useState(0);
  const [lines, setLines] = useState([]);
  const [input, setInput] = useState("");
  const [hintsUsed, setHintsUsed] = useState(0);
  const [startTime, setStartTime] = useState(null);
  const [playerName, setPlayerName] = useState("");
  const [leaderboard, setLeaderboard] = useState([]);
  const termRef = useRef(null);
  const inputRef = useRef(null);

  const scrollToBottom = useCallback(() => { if (termRef.current) setTimeout(() => { termRef.current.scrollTop = termRef.current.scrollHeight; }, 50); }, []);
  useEffect(() => { scrollToBottom(); }, [lines, scrollToBottom]);

  const startGame = (profileKey) => {
    const p = PROFILES[profileKey]; const gen = p.levels();
    setProfile(profileKey); setLevels(gen); setLevelIdx(0); setHintsUsed(0); setStartTime(Date.now());
    setLines([{ type:"system", text:"â•â•â•â•â•â• NIVEAU 1/" + gen.length + " : " + gen[0].title + " â•â•â•â•â•â•" },{ type:"system", text:"ğŸ“¡ " + gen[0].topic },{ type:"mission", text:gen[0].mission },{ type:"empty", text:"" }]);
    setScreen("game");
  };

  const addLines = (newLines, type) => { type = type || "response"; setLines((prev) => [...prev, ...newLines.map((text) => ({ type:type, text:text }))]); };

  const advanceLevel = () => {
    if (levelIdx < levels.length - 1) { const next = levelIdx + 1; setLevelIdx(next); setTimeout(() => { addLines(["","â•â•â•â•â•â• NIVEAU " + (next+1) + "/" + levels.length + " : " + levels[next].title + " â•â•â•â•â•â•","ğŸ“¡ " + levels[next].topic], "system"); addLines([levels[next].mission], "mission"); addLines([""], "empty"); }, 800); }
    else { setTimeout(() => setScreen("victory"), 1000); }
  };

  const handleCommand = (cmd) => {
    const original = cmd.trim(); const trimmed = original.toLowerCase(); if (!trimmed) return;
    setLines((prev) => [...prev, { type:"input", text:"â¯â¯ " + original }]);
    if (trimmed === "clear") { setLines([]); return; }
    if (trimmed === "mission") { addLines([levels[levelIdx].mission], "mission"); return; }
    if (trimmed === "hint") { setHintsUsed((h) => h + 1); addLines(["ğŸ’¡ " + levels[levelIdx].hint], "hint"); return; }
    if (trimmed === "score") { const e = Math.floor((Date.now() - startTime) / 1000); addLines(["Niveau: " + (levelIdx+1) + "/" + levels.length + " | Hints: " + hintsUsed + " | Temps: " + Math.floor(e/60) + "m" + String(e%60).padStart(2,"0") + "s"], "system"); return; }
    const cl = levels[levelIdx];
    const proc = (trimmed.startsWith("decode ") || trimmed.startsWith("caesar ") || trimmed.startsWith("login ") || trimmed.startsWith("try ")) ? original.replace(/^\S+/, (m) => m.toLowerCase()) : trimmed;
    if (cl.checkWin && cl.checkWin(proc)) { if (cl.winResponse) addLines(cl.winResponse, "success"); advanceLevel(); return; }
    if (cl.commands[trimmed]) { const r = cl.commands[trimmed]; addLines(r.response, r.nextLevel ? "success" : "response"); if (r.nextLevel) advanceLevel(); return; }
    if (cl.defaultResponse) { const r = cl.defaultResponse(proc); if (r) { addLines(r, "response"); return; } }
    addLines(["Commande non reconnue. Tapez 'help'."], "error");
  };

  const handleKeyDown = (e) => { if (e.key === "Enter") { handleCommand(input); setInput(""); } };
  const focusInput = () => { if (inputRef.current) inputRef.current.focus(); };
  const getScore = () => { const e = Math.floor((Date.now() - startTime) / 1000); const base = {"dÃ©butant":500,"intermÃ©diaire":750,"expert":1000}[profile] || 500; return Math.max(0, base - hintsUsed*50 - Math.floor(e/15)); };

  if (screen === "menu") {
    return (
      <div style={{minHeight:"100vh",background:"#0a0a0a",fontFamily:"'Fira Code','Cascadia Code',monospace",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"}}>
        <MatrixRain />
        <div style={{zIndex:10,textAlign:"center",maxWidth:"700px",padding:"20px"}}>
          <div style={{color:"#0a0",fontSize:"11px",letterSpacing:"8px",marginBottom:"16px",opacity:0.5}}>Ã‰COLE IT VALENCIENNES</div>
          <h1 style={{color:"#0f0",fontSize:"38px",margin:"0 0 6px",textShadow:"0 0 30px rgba(0,255,0,0.4)",letterSpacing:"4px"}}>CYBER TERMINAL</h1>
          <div style={{color:"#0a0",fontSize:"13px",letterSpacing:"5px",marginBottom:"40px",opacity:0.7}}>HACKING Ã‰THIQUE â€” V2</div>
          <div style={{marginBottom:"30px"}}>
            <input value={playerName} onChange={(e) => setPlayerName(e.target.value)} placeholder="Votre pseudo (optionnel)" maxLength={20} style={{background:"rgba(0,255,0,0.05)",border:"1px solid #1a3a1a",color:"#0f0",padding:"10px 16px",fontSize:"14px",fontFamily:"inherit",textAlign:"center",borderRadius:"4px",outline:"none",width:"250px"}} onFocus={(e) => {e.target.style.borderColor="#0f0";}} onBlur={(e) => {e.target.style.borderColor="#1a3a1a";}} />
          </div>
          <div style={{color:"#888",fontSize:"13px",marginBottom:"24px",letterSpacing:"2px"}}>CHOISISSEZ VOTRE NIVEAU</div>
          <div style={{display:"flex",gap:"16px",justifyContent:"center",flexWrap:"wrap"}}>
            {Object.entries(PROFILES).map(([key, p]) => (
              <button key={key} onClick={() => startGame(key)} style={{background:"rgba(0,0,0,0.8)",border:"1px solid " + p.color + "33",color:p.color,padding:"20px 24px",fontFamily:"inherit",fontSize:"13px",cursor:"pointer",borderRadius:"4px",width:"200px",textAlign:"left",transition:"all 0.3s",boxShadow:"0 0 20px " + p.color + "11"}} onMouseOver={(e) => {e.currentTarget.style.borderColor=p.color;e.currentTarget.style.boxShadow="0 0 30px " + p.color + "33";}} onMouseOut={(e) => {e.currentTarget.style.borderColor=p.color+"33";e.currentTarget.style.boxShadow="0 0 20px " + p.color + "11";}}>
                <div style={{fontSize:"16px",marginBottom:"8px",fontWeight:"bold"}}>{p.label}</div>
                <div style={{color:"#888",fontSize:"11px",lineHeight:"1.5"}}>{p.desc}</div>
                <div style={{color:"#555",fontSize:"10px",marginTop:"8px"}}>{p.levels().length} niveaux</div>
              </button>
            ))}
          </div>
          {leaderboard.length > 0 && (<div style={{marginTop:"40px",maxWidth:"400px",margin:"40px auto 0"}}><div style={{color:"#ff0",fontSize:"12px",letterSpacing:"2px",marginBottom:"12px"}}>ğŸ† LEADERBOARD</div>{leaderboard.slice(0,8).map((e,i) => (<div key={i} style={{display:"flex",justifyContent:"space-between",color:i===0?"#ff0":"#666",fontSize:"12px",padding:"4px 0",borderBottom:"1px solid #111"}}><span>{i+1}. {e.name}</span><span>{e.score} pts</span></div>))}</div>)}
        </div>
      </div>
    );
  }

  if (screen === "victory") {
    const elapsed = Math.floor((Date.now() - startTime) / 1000); const score = getScore(); const p = PROFILES[profile];
    return (
      <div style={{minHeight:"100vh",background:"#0a0a0a",fontFamily:"'Fira Code',monospace",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"}}>
        <MatrixRain />
        <div style={{zIndex:10,textAlign:"center",padding:"50px",border:"1px solid " + p.color + "44",borderRadius:"8px",background:"rgba(0,0,0,0.9)",boxShadow:"0 0 60px " + p.color + "15"}}>
          <div style={{fontSize:"48px",marginBottom:"16px"}}>ğŸ†</div>
          <h1 style={{color:p.color,fontSize:"26px",margin:"0 0 6px",letterSpacing:"4px"}}>MISSION ACCOMPLIE</h1>
          <div style={{color:"#555",fontSize:"12px",letterSpacing:"3px",marginBottom:"30px"}}>{p.label}</div>
          <div style={{color:"#888",marginBottom:"30px",lineHeight:"2.2",fontSize:"14px"}}>
            <div>Niveaux : <span style={{color:p.color}}>{levels.length}/{levels.length}</span></div>
            <div>Temps : <span style={{color:p.color}}>{Math.floor(elapsed/60)}m {String(elapsed%60).padStart(2,"0")}s</span></div>
            <div>Indices : <span style={{color:hintsUsed===0?"#0f0":"#ff0"}}>{hintsUsed}</span></div>
            <div style={{fontSize:"22px",marginTop:"8px"}}>Score : <span style={{color:p.color}}>{score}</span></div>
          </div>
          <div style={{display:"flex",gap:"12px",justifyContent:"center",flexWrap:"wrap"}}>
            <button onClick={() => { setLeaderboard((prev) => [...prev, {name:playerName||"Anonyme",score:score,profile:p.label,time:elapsed}].sort((a,b) => b.score-a.score)); setScreen("menu"); }} style={{background:p.color,color:"#000",border:"none",padding:"12px 28px",fontFamily:"inherit",fontSize:"13px",fontWeight:"bold",cursor:"pointer",letterSpacing:"2px",borderRadius:"2px"}}>SAUVER & MENU</button>
            <button onClick={() => startGame(profile)} style={{background:"transparent",color:p.color,border:"1px solid " + p.color,padding:"12px 28px",fontFamily:"inherit",fontSize:"13px",cursor:"pointer",letterSpacing:"2px",borderRadius:"2px"}}>REJOUER</button>
          </div>
        </div>
      </div>
    );
  }

  const p = PROFILES[profile];
  return (
    <div style={{minHeight:"100vh",background:"#0a0a0a",fontFamily:"'Fira Code',monospace",display:"flex",flexDirection:"column",position:"relative"}} onClick={focusInput}>
      <div style={{background:"#111",borderBottom:"1px solid #1a1a1a",padding:"10px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"8px",zIndex:10}}>
        <div style={{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"}}>
          <span style={{color:p.color,fontSize:"13px",fontWeight:"bold"}}>â¬¡ CYBER TERMINAL</span>
          <span style={{color:"#333"}}>|</span>
          <span style={{color:p.color,fontSize:"11px"}}>{p.label}</span>
          <span style={{color:"#333"}}>|</span>
          <span style={{color:"#0a0",fontSize:"11px"}}>{levels[levelIdx] && levels[levelIdx].title}</span>
        </div>
        <div style={{display:"flex",gap:"10px",alignItems:"center"}}>
          {playerName && <span style={{color:"#555",fontSize:"11px"}}>{playerName}</span>}
          <span style={{color:"#555",fontSize:"11px"}}>LVL {levelIdx+1}/{levels.length}</span>
          <div style={{display:"flex",gap:"3px"}}>
            {levels.map((_,i) => (<div key={i} style={{width:"7px",height:"7px",borderRadius:"50%",background:i<levelIdx?"#0f0":i===levelIdx?p.color:"#222",boxShadow:i<levelIdx?"0 0 4px #0f0":i===levelIdx?"0 0 6px "+p.color:"none",transition:"all 0.3s"}} />))}
          </div>
          <button onClick={() => setScreen("menu")} style={{background:"none",border:"1px solid #333",color:"#555",padding:"2px 8px",fontFamily:"inherit",fontSize:"10px",cursor:"pointer",borderRadius:"2px"}}>MENU</button>
        </div>
      </div>
      <div ref={termRef} style={{flex:1,overflowY:"auto",padding:"14px 16px",paddingBottom:"65px"}}>
        {lines.map((line,i) => {
          if (line.type === "empty") return <div key={i} style={{height:"10px"}} />;
          const colors = {system:"#0a0",input:"#fff",success:"#0f0",error:"#f44",hint:"#ff0",mission:"#6af",response:"#aaa"};
          return <div key={i} style={{color:colors[line.type]||"#aaa",fontSize:"13px",lineHeight:"1.6",whiteSpace:"pre-wrap",fontFamily:"inherit"}}>{line.text}</div>;
        })}
      </div>
      <div style={{position:"fixed",bottom:0,left:0,right:0,background:"#111",borderTop:"1px solid #1a1a1a",padding:"10px 16px",display:"flex",alignItems:"center",gap:"8px",zIndex:10}}>
        <span style={{color:p.color,fontSize:"14px"}}>â¯â¯</span>
        <input ref={inputRef} value={input} onChange={(e) => setInput(e.target.value)} onKeyDown={handleKeyDown} autoFocus placeholder="Tapez une commande..." style={{flex:1,background:"transparent",border:"none",outline:"none",color:"#fff",fontSize:"14px",fontFamily:"inherit",caretColor:p.color}} />
        <span style={{color:"#333",fontSize:"10px"}}>ENTER â†µ</span>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<HackerGame />);
    </script>
</body>
</html>